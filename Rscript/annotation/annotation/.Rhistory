if (is.data.frame(inFile)){dFiles[[2]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma3
if (is.data.frame(inFile)){dFiles[[3]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma4
if (is.data.frame(inFile)){dFiles[[4]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma5
if (is.data.frame(inFile)){dFiles[[5]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma6
if (is.data.frame(inFile)){dFiles[[6]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma7
if (is.data.frame(inFile)){dFiles[[7]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma8
if (is.data.frame(inFile)){dFiles[[8]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma9
if (is.data.frame(inFile)){dFiles[[9]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
inFile<- input$dogma10
if (is.data.frame(inFile)){dFiles[[10]]<-GnlBuilder(trnDogma(read.table(inFile$datapath)))}
dFiles[which(dFiles!="NULL")]
})
###ff for fasta files
ff<- reactive({
fFiles<- list()
inFile<- input$fas1
if (is.data.frame(inFile)){fFiles[[1]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas2
if (is.data.frame(inFile)){fFiles[[2]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas3
if (is.data.frame(inFile)){fFiles[[3]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas4
if (is.data.frame(inFile)){fFiles[[4]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas5
if (is.data.frame(inFile)){fFiles[[5]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas6
if (is.data.frame(inFile)){fFiles[[6]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas7
if (is.data.frame(inFile)){fFiles[[7]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas8
if (is.data.frame(inFile)){fFiles[[8]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas9
if (is.data.frame(inFile)){fFiles[[9]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
inFile<- input$fas10
if (is.data.frame(inFile)){fFiles[[10]]<-rdnFixerD(as.character(read.fasta(inFile$datapath)[[1]]))}
fFiles[which(fFiles!="NULL")]
})
###ii for IR info
ii<- reactive({
iFiles<- list()
inFile<-input$fas1
if (input$IR1=="" &&  is.data.frame(inFile)) {iFiles[[1]]<- 999}
else if(input$IR1!=""){iFiles[[1]]<- c(as.numeric(unlist(strsplit(input$IR1, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas2
if (input$IR2=="" &&  is.data.frame(inFile)) {iFiles[[2]]<- 999}
else if(input$IR2!=""){iFiles[[2]]<- c(as.numeric(unlist(strsplit(input$IR2, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas3
if (input$IR3=="" &&  is.data.frame(inFile)) {iFiles[[3]]<- 999}
else if(input$IR3!=""){iFiles[[3]]<- c(as.numeric(unlist(strsplit(input$IR3, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas4
if (input$IR4=="" &&  is.data.frame(inFile)) {iFiles[[4]]<- 999}
else if(input$IR4!=""){iFiles[[4]]<- c(as.numeric(unlist(strsplit(input$IR4, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas5
if (input$IR5=="" &&  is.data.frame(inFile)) {iFiles[[5]]<- 999}
else if(input$IR5!=""){iFiles[[5]]<- c(as.numeric(unlist(strsplit(input$IR5, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas6
if (input$IR6=="" &&  is.data.frame(inFile)) {iFiles[[6]]<- 999}
else if(input$IR6!=""){iFiles[[6]]<- c(as.numeric(unlist(strsplit(input$IR6, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas7
if (input$IR7=="" &&  is.data.frame(inFile)) {iFiles[[7]]<- 999}
else if(input$IR7!=""){iFiles[[7]]<- c(as.numeric(unlist(strsplit(input$IR7, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas8
if (input$IR8=="" &&  is.data.frame(inFile)) {iFiles[[8]]<- 999}
else if(input$IR8!=""){iFiles[[8]]<- c(as.numeric(unlist(strsplit(input$IR8, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas9
if (input$IR9=="" &&  is.data.frame(inFile)) {iFiles[[9]]<- 999}
else if(input$IR9!=""){iFiles[[9]]<- c(as.numeric(unlist(strsplit(input$IR9, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
inFile<-input$fas10
if (input$IR10=="" &&  is.data.frame(inFile)) {iFiles[[10]]<- 999}
else if(input$IR10!=""){iFiles[[10]]<- c(as.numeric(unlist(strsplit(input$IR10, split = ","))) , length(as.character(read.fasta(inFile$datapath)[[1]])))}
iFiles[which(iFiles!="NULL")]
})
###nf for the names of the species
nf<- reactive({
nFiles<- list()
inFile<- input$fas1
if (is.data.frame(inFile)){nFiles[[1]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas2
if (is.data.frame(inFile)){nFiles[[2]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas3
if (is.data.frame(inFile)){nFiles[[3]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas4
if (is.data.frame(inFile)){nFiles[[4]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas5
if (is.data.frame(inFile)){nFiles[[5]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas6
if (is.data.frame(inFile)){nFiles[[6]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas7
if (is.data.frame(inFile)){nFiles[[7]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas8
if (is.data.frame(inFile)){nFiles[[8]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas9
if (is.data.frame(inFile)){nFiles[[9]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
inFile<- input$fas10
if (is.data.frame(inFile)){nFiles[[10]]<-gsub("_", " ", names(read.fasta(inFile$datapath)))}
nFiles[which(nFiles!="NULL")]
})
#output$markdown <- renderUI({
#  HTML(markdown::markdownToHTML(knit('Rmarkdown.Rmd', quiet = TRUE)))
#})
#doog <- readLines("dogma.txt")
output$downloadDogma <- downloadHandler(###Downloading the Dogma file
filename = function() {
paste("annotation-", Sys.Date(), ".txt", sep="")
},
content = function(file) {
writeLines(doog, file)
}
)
#pic1 <- readJPEG("IR1.jpg")
#pic2 <- readJPEG("IRprevioustest.jpg")
output$downloadPIC1 <- downloadHandler(###Downloading the first PIC
filename = function() {
paste("IR1example-", Sys.Date(), ".jpg", sep="")
},
content = function(file) {
writeJPEG(pic1, file)
}
)
output$downloadPIC2 <- downloadHandler(###Downloading the first PIC
filename = function() {
paste("IR2example-", Sys.Date(), ".jpg", sep="")
},
content = function(file) {
writeJPEG(pic2, file)
}
)
#data <- readLines("IRscope.R")
output$downloadDat <- downloadHandler(###Downloading the R codes
filename = function() {
paste("data-", Sys.Date(), ".R", sep="")
},
content = function(file) {
writeLines(data, file)
}
)
### Updating the section areas of the borowsed files in GB section
output$sp1 <- renderText({
if (input$acc1!="") {print(head(fetch.gb(input$acc1))[2])}
else {
frame1<- input$data1
if (is.data.frame(frame1)) {print(readLines(frame1$datapath)[2])}
}
#isolate(input$clear1)
#emp<- isolate(input$sp1)
#emp
})
output$sp2 <- renderText({ if (input$acc2!="") {print(head(fetch.gb(input$acc2))[2])}
else {
frame2<- input$data2
if (is.data.frame(frame2)) {print(readLines(frame2$datapath)[2])}
}
})
output$sp3 <- renderText({ if (input$acc3!="") {print(head(fetch.gb(input$acc3))[2])}
else {
frame3<- input$data3
if (is.data.frame(frame3)) {print(readLines(frame3$datapath)[2])}
}
})
output$sp4 <- renderText({ if (input$acc4!="") {print(head(fetch.gb(input$acc4))[2])}
else {
frame4<- input$data4
if (is.data.frame(frame4)) {print(readLines(frame4$datapath)[2])}
}
})
output$sp5 <- renderText({ if (input$acc5!="") {print(head(fetch.gb(input$acc5))[2])}
else {
frame5<- input$data5
if (is.data.frame(frame5)) {print(readLines(frame5$datapath)[2])}
}
})
output$sp6 <- renderText({ if (input$acc6!="") {print(head(fetch.gb(input$acc6))[2])}
else {
frame6<- input$data6
if (is.data.frame(frame6)) {print(readLines(frame6$datapath)[2])}
}
})
output$sp7 <- renderText({ if (input$acc7!="") {print(head(fetch.gb(input$acc7))[2])}
else {
frame7<- input$data7
if (is.data.frame(frame7)) {print(readLines(frame7$datapath)[2])}
}
})
output$sp8 <- renderText({ if (input$acc8!="") {print(head(fetch.gb(input$acc8))[2])}
else {
frame8<- input$data8
if (is.data.frame(frame8)) {print(readLines(frame8$datapath)[2])}
}
})
output$sp9 <- renderText({ if (input$acc9!="") {print(head(fetch.gb(input$acc9))[2])}
else {
frame9<- input$data9
if (is.data.frame(frame9)) {print(readLines(frame9$datapath)[2])}
}
})
output$sp10 <- renderText({
if (input$acc10!="") {print(head(fetch.gb(input$acc10))[2])}
else {
frame10<- input$data10
if (is.data.frame(frame10)) {print(readLines(frame10$datapath)[2])}
}
})
}
shinyApp(ui, server)
shiny::runApp('C:/Users/fish/Desktop')
BiocManager::install("BSgenome")
library(BSgenome)
BiocManager::install("BSgenome")
biocLite("BSgenome")
BiocManager::install("biocLite")
BiocManager::install("BSgenome")
BiocManager::install("BSgenome")
BiocManager
version('BiocManager')
??BiocManager
??(BiocManager)
?(BiocManager)
library(BiocManager)
BiocManager::install("BSgenome")
BiocManager::install("BSgenome.Hsapiens.UCSC.hg19")
library(ggplot2)
cd <-read.csv("C:/Users/fish/Desktop/test/28.Rosa_36_IGS_extract/06.SNP_analysis_Pi/IGS_pi_SNP_analysis_final.csv" ,sep=",")
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
ggplot(cd,aes(x=IGS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
cd
ggplot(cd,aes(x=IGS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
cd <-read.csv("C:/Users/fish/Desktop/test/28.Rosa_36_IGS_extract/06.SNP_analysis_Pi/Pi_analysis.csv" ,sep=",")
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
cd <-read.csv("C:/Users/fish/Desktop/test/28.Rosa_36_IGS_extract/06.SNP_analysis_Pi/IGS_pi_SNP_analysis_final.csv" ,sep=",")
ggplot(cd,aes(x=IGS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
cd <-read.csv("C:/Users/fish/Desktop/test/28.Rosa_36_IGS_extract/06.SNP_analysis_Pi/IGS_pi_SNP_analysis_final.csv" ,sep=",")
ggplot(cd,aes(x=IGS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
library(seqinr)
library(ape)
library(shape)
library(diagram)
library(reutils)
library(snow)
library(snowfall)
library(knitr)
library(shiny)
library(jpeg)
runApp('C:/Users/fish/Desktop')
runApp('C:/Users/fish/Desktop/data-2021-03-31.R')
runApp('C:/Users/fish/Desktop')
runApp('C:/Users/fish/Desktop')
runApp('C:/Users/fish/Desktop')
runApp('C:/Users/fish/Desktop')
runApp('C:/Users/fish/Desktop')
library(ggplot2)
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16 ,hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=12 ,hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=14 ,hjust=1,vjust = .5))
library(ggplot2)
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=14 ,hjust=1,vjust = .5))
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
cd
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=14 ,hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=14 ,hjust=1,vjust = .5)) + scale_x_discrete(limits=cd$CDS)
shiny::runApp('C:/Users/fish/Desktop')
library(ggplot2)
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
cd
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 , hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=5,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = 1))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line() + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=4, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=2, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=1, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=1, shape=10) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=1, shape=1) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=1) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=1) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=2) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.5) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.8) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.8, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),plot.background = element_rect(fill = 'green', colour = 'red'))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),plot.background = element_rect(fill = 'write', colour = 'red'))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),plot.background = element_rect(fill = 'write', colour = 'red'))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),plot.background = element_rect(fill = 'white', colour = 'red'))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),plot.background = element_rect（fill ='green'，color ='red'）)
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),panel.background = element_rect(fill = "transparent",colour = NA),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
plot.background = element_rect(fill = "transparent",colour = NA))
library(ggplot2)
cd <-read.csv("C:/Users/fish/Desktop/test/26.yinyanghuo/02.cds/CDS_Pi_77.csv" ,sep=",")
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),panel.background = element_rect(fill = "transparent",colour = NA),panel.grid.minor = element_blank(),panel.grid.major = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),panel.background = element_rect(fill = "transparent",colour = NA),panel.grid.minor = element_blank(),panel.grid.major = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5))
ggplot(cd,aes(x=CDS,y=pi,group=1)) + geom_line(size=0.9, shape=20) + geom_point() + theme(axis.text.x = element_text(angle = 90 ,family='Times',face='bold' ,size=16, hjust=1,vjust = .5),panel.background = element_rect(fill = "transparent",colour = NA),panel.grid.minor = element_blank(),panel.grid.major = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)) +scale_x_discrete(limits=cd$CDS)
shiny::runApp('C:/Users/fish/Desktop')
View(thFinder)
View(md)
View(GeneList)
runApp('C:/Users/fish/Desktop/app_test.R')
runApp('C:/Users/fish/Desktop/app_test.R')
runApp('C:/Users/fish/Desktop/bioinformatics_tools/IRscope_app_new.R')
runApp('C:/Users/fish/Desktop/bioinformatics_tools/IRscope_app_new.R')
runApp('C:/Users/fish/Desktop/bioinformatics_tools/IRscope_app_new.R')
runApp('C:/Users/fish/Desktop/bioinformatics_tools/IRscope_app_new.R')
library(shiny); runApp('C:/Users/fish/Desktop/bioinformatics_tools/IRscope_app_new_test.R')
library(shiny); runApp('C:/Users/fish/Desktop/bioinformatics_tools/IRscope_app_new.R')
library("clusterProfiler")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.13")
library(BiocManager)
detach("package:BiocManager", unload = TRUE)
library(BiocManager)
BiocManager::install("clusterProfiler")
library(clusterProfiler)
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
library(clusterProfiler)
install.packages("vctrs")
library(clusterProfiler)
install.packages("vctrs")
install.packages("vctrs")
library(clusterProfiler)
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
library(clusterProfiler)
remove.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
library(vctrs)
library(clusterProfiler)
BiocManager::install("org.Hs.eg.db")
library(org.Hs.eg.db)
library(pheatmap)
library(stringr)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("pathview")
remove.packages(xfun)
remove.packages("xfun")
install.packages("xfun")
install.packages("xfun")
library("pathview")
install.packages("qqman")
library(agricolae)
install.packages("agricolae")
setwd("d:/pll/R_work/Venn")
data.nr<-read.table("Trifolium_repens_Baisanye_unigene_CDS_nr_diamond.blast",sep="\t",header=T,row.names=1)
data.nr<-read.table("Trifolium_repens_Baisanye_unigene_CDS_nr_diamond_uniq.blast",sep="\t",header=F)
x<-data.nr[,3]
tmp<-hist(x)
bin.start<-tmp$breaks[-length(tmp$breaks)]
bin.end<-tmp$breaks[-1]
identity<-paste(bin.start,bin.end,sep="-")
count<-tmp$counts
id.count<-data.frame(Identity=identity,Count=count)
newlegend <- paste(id.count$Identity, " (", round(id.count$Count/sum(id.count$Count)* 100, 2), "%)", sep = "")
id.p<-ggplot(id.count, aes(x = "", y = Count, fill = Identity)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = id.count$Identity, labels = newlegend)+ggtitle("Identity distribution")
newlegend <- paste(id.count$Identity, " (", round(id.count$Count/sum(id.count$Count)* 100, 2), "%)", sep = "")
id.p<-ggplot(id.count, aes(x = "", y = Count, fill = Identity)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = id.count$Identity, labels = newlegend)+ggtitle("Identity distribution")
library(ggplot2)
library(ggthemes)
id.p<-ggplot(id.count, aes(x = "", y = Count, fill = Identity)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = id.count$Identity, labels = newlegend)+ggtitle("Identity distribution")
ggsave("nr_id_distribution.jpeg",id.p,dpi=320,width=10)
evalue<-data.nr[,11]
evalue.hist<-hist(evalue)
evalue.hist<-hist(evalue)
evalue.hist$breaks
evalue.hist<-hist(evalue,breaks=50)
evalue.hist<-hist(evalue,breaks=100)
evalue.hist$breaks
evalue.hist<-hist(evalue,breaks=1000)
hist(evalue,breaks=1000)
hist(evalue,breaks=10000)
hist(evalue,breaks=5)
hist(evalue,breaks=3)
hist(evalue,breaks=2)
hist(evalue)
evalue.hist<-hist(evalue)
evalue.hist$breaks
evalue.hist$counts
evalue.hist<-hist(evalue,breaks=5)
evalue.hist$breaks
evalue.hist$counts
evalue.hist<-hist(evalue,breaks=10)
evalue.hist$breaks
evalue.hist$counts
e_value<-paste(e.start,e.end,sep="-")
e.start<-evalue.hist$breaks[-length(evalue.hist$breaks)]
e.end<-evalue.hist$breaks[-1]
e_value<-paste(e.start,e.end,sep="-")
e_count<-evalue.hist$counts
e.count<-data.frame(e_value=e_value,Count=e_count)
e.p<-ggplot(e.count, aes(x = "", y = Count, fill = e_value)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = e.count$e_value)+ggtitle("E value distribution")
e.p
e_value<-paste(e.start,e.end,sep="~")
e.start
as.character(e.start)
gsub(".00000000000001",'',as.character(e.start))
e.end<-evalue.hist$breaks[-1]
e.end<-gsub(".00000000000001",'',as.character(e.end))
e_value<-paste(e.start,e.end,sep="~")
e_count<-evalue.hist$counts
e.count<-data.frame(e_value=e_value,Count=e_count)
e.p<-ggplot(e.count, aes(x = "", y = Count, fill = e_value)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = e.count$e_value)+ggtitle("E value distribution")
e.p
e.start<-gsub(".00000000000001",'',as.character(e.start))
evalue<-data.nr[,11]
evalue.hist<-hist(evalue,breaks=10)
e.start<-evalue.hist$breaks[-length(evalue.hist$breaks)]
e.start<-gsub(".00000000000001",'',as.character(e.start))
e.end<-evalue.hist$breaks[-1]
e.end<-gsub(".00000000000001",'',as.character(e.end))
e_value<-paste(e.start,e.end,sep="~")
e_count<-evalue.hist$counts
e.count<-data.frame(e_value=e_value,Count=e_count)
e.p<-ggplot(e.count, aes(x = "", y = Count, fill = e_value)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = e.count$e_value)+ggtitle("E value distribution")
e.p
evalue<-data.nr[,11]
evalue.hist<-hist(evalue,breaks=10)
e.start<-evalue.hist$breaks[-length(evalue.hist$breaks)]
e.start<-gsub(".00000000000001",'',as.character(e.start))
e.end<-evalue.hist$breaks[-1]
e.end<-gsub(".00000000000001",'',as.character(e.end))
e_value<-paste(e.start,e.end,sep="~~")
e_count<-evalue.hist$counts
e.count<-data.frame(e_value=e_value,Count=e_count)
e.p<-ggplot(e.count, aes(x = "", y = Count, fill = e_value)) + geom_bar(stat = "identity") + coord_polar(theta = "y") +
theme_base()+theme(panel.grid = element_blank(), axis.text = element_blank(), axis.title = element_blank(), axis.ticks = element_blank())+
scale_fill_discrete(breaks = e.count$e_value)+ggtitle("E value distribution")
e.p
ggsave("nr_evalue_distribution.jpeg",id.p,dpi=320,width=10)
ggsave("nr_evalue_distribution.jpeg",e.p,dpi=320,width=10)
?gsub
sp<-data.nr[,13]
gsub('.+\\[',"",sp,perl=TRUE)->sp
gsub('\\]',"",sp,perl=TRUE)->sp
head(sp)
sp.dt<-data.frame(table(sp))
head(sp.dt)
sp<-data.nr[,13]
gsub('.+\\[',"",sp,perl=TRUE)->sp
gsub('\\]\n',"",sp,perl=TRUE)->sp
head(sp)
sp<-data.nr[,13]
gsub('.+\\[',"",sp,perl=TRUE)->sp
gsub('\\]',"",sp,perl=TRUE)->sp
head(sp)
gsub("\n","",sp,perl=TRUE)->sp
head(sp)
sp.dt<-data.frame(table(sp))
head(sp.dt)
dim(sp.dt)
table(as.character(sp))
sp.dt<-data.frame(table(as.character(sp)
)
sp.dt<-as.data.frame(table(as.character(sp)))
dim(sp.dt)
head(sp.dt)
sp<-data.nr[,13]
gsub('.+\\[',"",sp,perl=TRUE)->sp
class(data.nr[,13])
sp<-as.vector(data.nr[,13])
gsub('.+\\[',"",sp,perl=TRUE)->sp
gsub('\\]',"",sp,perl=TRUE)->sp
sp.dt<-as.data.frame(table(as.character(sp)))
species<-read.table("species_count.txt",sep="\t",header=F,check.names = F)
