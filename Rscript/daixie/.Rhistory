q()
getwd()
install.packages('Mfuzz')
install.packages("ape")
library(ape)
setwd("C:/Users/Analysis/OneDrive/Work/zhiwusuo/00_Script/02_Rscript/GWAS/谷子")
setwd("C:/Users/Analysis/OneDrive/Work/zhiwusuo/00_Script/02_Rscript/GWAS/谷子")
library("GWASpoly")
prefix<-"mature"
traits<-13
N<-203
#设置miss率为0.05
VCF2dosage(
VCF.file = paste0(prefix, "_stage.recode.vcf"),
dosage.file = paste0(prefix, "_dp1_miss_0.05.csv"),
geno.code="GT",ploidy=2,samples=NULL,min.DP=1, max.missing=0.05, min.minor=5)
#genofile <- system.file("extdata", "new_potato_geno.csv", package = "GWASpoly")
#phenofile <- system.file("extdata", "new_potato_pheno.csv", package = "GWASpoly")
dir()
genofile<-paste0(prefix, "_dp1_miss_0.05.csv")
phenofile<-paste0(prefix, "_stage_phe_all.csv")
#######注意修改n.traits这个参数，确定表型参数个数
data <- read.GWASpoly(ploidy=2, pheno.file=phenofile, geno.file=genofile,
format="numeric", n.traits=traits, delim=",")
class(data)
#data.loco <- set.K(data,LOCO=TRUE,n.core=2)
###为了做后面的qtl，所以这里选择参数LOCO=F
data.original <- set.K(data,LOCO=FALSE,n.core=2)
params <- set.params(geno.freq = 1 - 2/N, fixed = "env", fixed.type = "factor",MAF = 0.01,n.PC=5)
#data.loco.scan
data.original.scan <- GWASpoly(data.original,models=c("additive","1-dom"),
params=params,n.core=2)
#?GWASpoly
library(ggplot2)
for(i in paste0("trait",1:tratis)){
qq.p<-qq.plot(data.original.scan,trait= i) + ggtitle(label="Original")
outfile<-paste0(prefix,"_",i,"_qq.jpeg")
ggsave(outfile,qq.p,dpi=350)
}
#?GWASpoly
library(ggplot2)
for(i in paste0("trait",1:traits)){
qq.p<-qq.plot(data.original.scan,trait= i) + ggtitle(label="Original")
outfile<-paste0(prefix,"_",i,"_qq.jpeg")
ggsave(outfile,qq.p,dpi=350)
}
rm(i)
#data2 <- set.threshold(data.original.scan,method="Bonferroni",level=0.05)
data2 <- set.threshold(data.original.scan,method="M.eff",level=0.05)
BiocVersion::
BiocManager::version(BiocManager)
BiocManager::install("edgeR")
data2
#########上面这一步产生-log10(p)的阈值，会显示在后面的曼哈顿图中，要记录下来，这个样品中是5.56
class(data2)
summary(data2)
library(ggthemes)
library(ggplot2)
library(pheatmap)
library(reshape2)
library(ggcorrplot)
library(corrplot)
library(DESeq2)
library(edgeR)
?openxlsx
??openxlsx
reads_data<-read.table("ALL_sample_data",sep="\t",row.names=1,header=T,check.names=F,stringsAsFactors = F)
reads_data<-read.table("ALL_sample_data.txt",sep="\t",row.names=1,header=T,check.names=F,stringsAsFactors = F)
setwd("C:/Users/Analysis/OneDrive/Work/zhiwusuo/00_Script/02_Rscript/代谢整体分析图")
reads_data<-read.table("ALL_sample_data.txt",sep="\t",row.names=1,header=T,check.names=F,stringsAsFactors = F)
fpkm<-apply(reads_data,1,function(x){(x-mean(x))/(sd(x)**0.5)})
rm(list=ls())
getwd()
reads_data<-read.table("ALL_sample_data.txt",sep="\t",row.names=1,header=T,check.names=F,stringsAsFactors = F)
View(reads_data)
log(1.5)
log(1.7)
log(1.6)
log(1.65)
