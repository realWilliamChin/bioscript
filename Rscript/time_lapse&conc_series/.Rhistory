data<-read_xlsx("Relief_Group_1.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group_1_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
length(p)
#head(p)
data$p_value<-p
data<-data[order(data$p_value),]
#head(data)
#?p.adjust
p.adjust(data$p_value,method = "BH")->p.aj
#head(p.aj)
data$BH_p_value<-p.aj
#head(data)
df.rname<-data.frame(GeneID=rownames(data))
data<-cbind(df.rname,data)
head(data)
write.table(data,"anova_analysis_seed_vs_germinated_p.txt",sep="\t",quote=F,row.names = F)
##############################################################################################################
setwd("d:/pll/R_work/RNA-seq/Niubang/anova/")
############Niubang germinated
library(readxl)
data<-read_xlsx("Relief_Group_1.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group_1_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
length(p)
#head(p)
data$p_value<-p
data<-data[order(data$p_value),]
#head(data)
#?p.adjust
p.adjust(data$p_value,method = "BH")->p.aj
#head(p.aj)
data$BH_p_value<-p.aj
#head(data)
df.rname<-data.frame(GeneID=rownames(data))
data<-cbind(df.rname,data)
head(data)
write.table(data,"anova_analysis_seed_vs_germinated_p.txt",sep="\t",quote=F,row.names = F)
##############################################################################################################
setwd("d:/pll/R_work/RNA-seq/Niubang/anova/")
############Niubang germinated
library(readxl)
data<-read_xlsx("Relief_Group_1.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group_1_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
length(p)
##############################################################################################################
setwd("d:/pll/R_work/RNA-seq/Niubang/anova/")
############Niubang germinated
library(readxl)
data<-read_xlsx("Relief_Group_1.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group_1_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
length(p)
#head(p)
data$p_value<-p
data<-data[order(data$p_value),]
#head(data)
#?p.adjust
p.adjust(data$p_value,method = "BH")->p.aj
#head(p.aj)
data$BH_p_value<-p.aj
#head(data)
df.rname<-data.frame(GeneID=rownames(data))
data<-cbind(df.rname,data)
head(data)
write.table(data,"Relief_Group_1_p.txt",sep="\t",quote=F,row.names = F)
##############################################################################################################
setwd("D:/chenshen/R_work/multi_anova")
############Niubang germinated
library(readxl)
data<-read_xlsx("all_gene_id_fpkm.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
data<-read_xlsx("Relief_Group2.xlsx",1)
##############################################################################################################
setwd("D:/chenshen/R_work/multi_anova")
############Niubang germinated
library(readxl)
data<-read_xlsx("Relief_Group2.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group2_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
length(p)
#head(p)
data$p_value<-p
data<-data[order(data$p_value),]
#head(data)
#?p.adjust
p.adjust(data$p_value,method = "BH")->p.aj
#head(p.aj)
data$BH_p_value<-p.aj
#head(data)
df.rname<-data.frame(GeneID=rownames(data))
data<-cbind(df.rname,data)
write.table(data,"Relief_Group2_p.txt",sep="\t",quote=F,row.names = F)
############Niubang germinated
library(readxl)
data<-read_xlsx("Relief_Group.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
head(data)
write.table(data,"Relief_Group_p.txt",sep="\t",quote=F,row.names = F)
data<-read_xlsx("Relief_Group.xlsx",1)
data<-as.data.frame(data)
head(data)
rownames(data)<-data$GeneID
data<-data[,-1]
data<-subset(data,rowSums(data)>0)
#data<-read.table("ABA_FPKM.txt",sep="\t",row.names=1,header=T,check.names=F)
group<-read.table("Relief_Group_group.txt",sep="\t",header=T,check.names = F)
#head(group)
group
colnames(data)
#match(colnames(data),group$sample)
#order(match(colnames(data),group$sample))
#group[match(colnames(data),group$sample),]
tmp.group<-group$group[match(colnames(data),group$sample)]
tmp.group
#class(tmp.group)
#head(data)
p<-NULL
for (i in rownames(data)) {
#print(i);
#print(data[i,])
tmp.count<-as.numeric(data[i,])
#tmp.dt<-data.frame(tmp.count,group=rep(c("S1","S3","S2"),each=3))
tmp.dt<-data.frame(tmp.count,group=tmp.group)
colnames(tmp.dt)[1]<-i
tmp.dt$group<-as.factor(tmp.dt$group)
mod <- aov( tmp.dt[,1]~group , data = tmp.dt)
p<-c(p,summary(mod)[[1]][5]$Pr[1])
}
length(p)
#head(p)
data$p_value<-p
data<-data[order(data$p_value),]
#head(data)
#?p.adjust
p.adjust(data$p_value,method = "BH")->p.aj
#head(p.aj)
data$BH_p_value<-p.aj
#head(data)
df.rname<-data.frame(GeneID=rownames(data))
data<-cbind(df.rname,data)
head(data)
write.table(data,"Relief_Group_p.txt",sep="\t",quote=F,row.names = F)
##############################################################################################################
setwd("D:/chenshen/R_work/multi_anova")
############Niubang germinated
library(readxl)
library(Mfuzz)
library(factoextra)
library(cluster)
setwd("D:/chenshen/R_work/cluster")
#读取矩阵表格，在我网盘中，示例数据为“mmc2.union_all_protein_exp.txt”
#该示例中，行为基因或蛋白名称，列为时间样本（按时间顺序提前排列好，若存在生物学重复需提前取均值）
protein <- read.delim('Relapse_Group2_annovafiltered_fpkm.txt', row.names = 1, check.names = FALSE)
#protein<-read_xlsx("gene_id_germinated.xlsx",1)
protein <- as.matrix(protein)
#load data
df <- protein
#remove rows with missing values
df <- na.omit(df)
#scale each variable to have a mean of 0 and sd of 1
df <- scale(df)
#view first six rows of dataset
head(df)
fviz_nbclust(df, kmeans, method = "wss")
#加载 Mfuzz 包
library(Mfuzz)
#构建对象
mfuzz_class <- new('ExpressionSet',exprs = protein)
#预处理缺失值或者异常值
mfuzz_class <- filter.NA(mfuzz_class, thres = 0.25)
mfuzz_class <- fill.NA(mfuzz_class, mode = 'mean')
mfuzz_class <- filter.std(mfuzz_class, min.std = 0)
#标准化数据
mfuzz_class <- standardise(mfuzz_class)
#Mfuzz 基于 fuzzy c-means 的算法进行聚类，详情 ?mfuzz
#需手动定义目标聚类群的个数，例如这里我们为了重现原作者的结果，设定为 10，即期望获得 10 组聚类群
#需要设定随机数种子，以避免再次运行时获得不同的结果
set.seed(123)
cluster_num <- 6
mfuzz_cluster <- mfuzz(mfuzz_class, c = cluster_num, m = mestimate(mfuzz_class))
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 2)
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 1)
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 1)
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 1)
library(Mfuzz)
library(factoextra)
library(cluster)
setwd("D:/chenshen/R_work/cluster")
#读取矩阵表格，在我网盘中，示例数据为“mmc2.union_all_protein_exp.txt”
#该示例中，行为基因或蛋白名称，列为时间样本（按时间顺序提前排列好，若存在生物学重复需提前取均值）
protein <- read.delim('Relief_Group_annovafiltered_fpkm.txt', row.names = 1, check.names = FALSE)
#protein<-read_xlsx("gene_id_germinated.xlsx",1)
protein <- as.matrix(protein)
#load data
df <- protein
#remove rows with missing values
df <- na.omit(df)
#scale each variable to have a mean of 0 and sd of 1
df <- scale(df)
#view first six rows of dataset
head(df)
fviz_nbclust(df, kmeans, method = "wss")
#加载 Mfuzz 包
library(Mfuzz)
#构建对象
mfuzz_class <- new('ExpressionSet',exprs = protein)
#预处理缺失值或者异常值
mfuzz_class <- filter.NA(mfuzz_class, thres = 0.25)
mfuzz_class <- fill.NA(mfuzz_class, mode = 'mean')
mfuzz_class <- filter.std(mfuzz_class, min.std = 0)
#标准化数据
mfuzz_class <- standardise(mfuzz_class)
#Mfuzz 基于 fuzzy c-means 的算法进行聚类，详情 ?mfuzz
#需手动定义目标聚类群的个数，例如这里我们为了重现原作者的结果，设定为 10，即期望获得 10 组聚类群
#需要设定随机数种子，以避免再次运行时获得不同的结果
set.seed(123)
cluster_num <- 7
mfuzz_cluster <- mfuzz(mfuzz_class, c = cluster_num, m = mestimate(mfuzz_class))
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 1)
#查看每个聚类群中各自包含的蛋白数量
cluster_size <- mfuzz_cluster$size
names(cluster_size) <- 1:cluster_num
cluster_size
#查看每个蛋白所属的聚类群
head(mfuzz_cluster$cluster)
#Mfuzz 通过计算一个叫 membership 的统计量判断蛋白质所属的聚类群，以最大的 membership 值为准
#查看各蛋白的 membership 值
head(mfuzz_cluster$membership)
cluster <- mfuzz_cluster$cluster
cluster <- cbind(protein[names(protein_cluster), ], cluster)
head(cluster)
write.table(cluster, 'Relief_Group_culster.txt', sep = '\t', col.names = NA, quote = FALSE)
cluster
library(Mfuzz)
library(factoextra)
library(cluster)
setwd("D:/chenshen/R_work/cluster")
#读取矩阵表格，在我网盘中，示例数据为“mmc2.union_all_protein_exp.txt”
#该示例中，行为基因或蛋白名称，列为时间样本（按时间顺序提前排列好，若存在生物学重复需提前取均值）
protein <- read.delim('Relapse_Group2_annovafiltered_fpkm.txt', row.names = 1, check.names = FALSE)
#protein<-read_xlsx("gene_id_germinated.xlsx",1)
protein <- as.matrix(protein)
#加载 Mfuzz 包
library(Mfuzz)
#构建对象
mfuzz_class <- new('ExpressionSet',exprs = protein)
#预处理缺失值或者异常值
mfuzz_class <- filter.NA(mfuzz_class, thres = 0.25)
mfuzz_class <- fill.NA(mfuzz_class, mode = 'mean')
mfuzz_class <- filter.std(mfuzz_class, min.std = 0)
#标准化数据
mfuzz_class <- standardise(mfuzz_class)
#Mfuzz 基于 fuzzy c-means 的算法进行聚类，详情 ?mfuzz
#需手动定义目标聚类群的个数，例如这里我们为了重现原作者的结果，设定为 10，即期望获得 10 组聚类群
#需要设定随机数种子，以避免再次运行时获得不同的结果
set.seed(123)
cluster_num <- 6
mfuzz_cluster <- mfuzz(mfuzz_class, c = cluster_num, m = mestimate(mfuzz_class))
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 2)
cluster_num <- 6
mfuzz_cluster <- mfuzz(mfuzz_class, c = cluster_num, m = mestimate(mfuzz_class))
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 2)
#查看每个聚类群中各自包含的蛋白数量
cluster_size <- mfuzz_cluster$size
names(cluster_size) <- 1:cluster_num
cluster_size
#查看每个蛋白所属的聚类群
head(mfuzz_cluster$cluster)
#Mfuzz 通过计算一个叫 membership 的统计量判断蛋白质所属的聚类群，以最大的 membership 值为准
#查看各蛋白的 membership 值
head(mfuzz_cluster$membership)
protein_cluster <- mfuzz_cluster$cluster
protein_cluster <- cbind(protein[names(protein_cluster), ], protein_cluster)
head(protein_cluster)
write.table(protein_cluster, 'Relapse_Group2_cluster.txt', sep = '\t', col.names = NA, quote = FALSE)
#读取矩阵表格，在我网盘中，示例数据为“mmc2.union_all_protein_exp.txt”
#该示例中，行为基因或蛋白名称，列为时间样本（按时间顺序提前排列好，若存在生物学重复需提前取均值）
protein <- read.delim('Relief_Group_annovafiltered_fpkm.txt', row.names = 1, check.names = FALSE)
#protein<-read_xlsx("gene_id_germinated.xlsx",1)
protein <- as.matrix(protein)
#load data
df <- protein
#remove rows with missing values
df <- na.omit(df)
#scale each variable to have a mean of 0 and sd of 1
df <- scale(df)
#view first six rows of dataset
head(df)
fviz_nbclust(df, kmeans, method = "wss")
#加载 Mfuzz 包
library(Mfuzz)
#构建对象
mfuzz_class <- new('ExpressionSet',exprs = protein)
#预处理缺失值或者异常值
mfuzz_class <- filter.NA(mfuzz_class, thres = 0.25)
mfuzz_class <- fill.NA(mfuzz_class, mode = 'mean')
mfuzz_class <- filter.std(mfuzz_class, min.std = 0)
#标准化数据
mfuzz_class <- standardise(mfuzz_class)
#Mfuzz 基于 fuzzy c-means 的算法进行聚类，详情 ?mfuzz
#需手动定义目标聚类群的个数，例如这里我们为了重现原作者的结果，设定为 10，即期望获得 10 组聚类群
#需要设定随机数种子，以避免再次运行时获得不同的结果
set.seed(123)
cluster_num <- 7
mfuzz_cluster <- mfuzz(mfuzz_class, c = cluster_num, m = mestimate(mfuzz_class))
#作图，详情 ?mfuzz.plot2
#time.labels 参数设置时间轴，需要和原基因表达数据集中的列对应
#颜色、线宽、坐标轴、字体等细节也可以添加其他参数调整，此处略，详见函数帮助
mfuzz.plot2(mfuzz_class, cl = mfuzz_cluster, mfrow = c(4,2 ), time.labels = colnames(protein), las = 2)
#查看每个聚类群中各自包含的蛋白数量
cluster_size <- mfuzz_cluster$size
names(cluster_size) <- 1:cluster_num
cluster_size
#查看每个蛋白所属的聚类群
head(mfuzz_cluster$cluster)
#Mfuzz 通过计算一个叫 membership 的统计量判断蛋白质所属的聚类群，以最大的 membership 值为准
#查看各蛋白的 membership 值
head(mfuzz_cluster$membership)
protein_cluster <- mfuzz_cluster$cluster
protein_cluster <- cbind(protein[names(protein_cluster), ], protein_cluster)
head(protein_cluster)
write.table(protein_cluster, 'Relief_Group_cluster.txt', sep = '\t', col.names = NA, quote = FALSE)
